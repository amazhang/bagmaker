function loadBags(){$.getJSON("/totes",function(t){toteBags=t,$.each(t,function(t,e){var a=$("<div/>",{id:"tote-"+t,"class":"tote-grid-element start",html:"<div class='heart-wrap'><div class='heart-circle'></div><div class='heart'><div class='inner-heart grey'></div><div class='inner-heart white'></div></div></div><div class='grid-wrap'><div class='actual-tote "+e.size+" "+e.color+"'><div class='text-wrap'>"+e.text+"</div><div class='tote-shadow'></div></div></div>"});a.find(".text-wrap").css("text-align",e.justification),a.find(".text-wrap").css("font-size",e.fontSize+"em"),a.find(".text-wrap").css("letter-spacing",e.kerning+"em"),a.find(".text-wrap").css("line-height",e.leading+"em");var r=Number(e.yAxis)*multiplier/maxColumns;a.find(".text-wrap").css("transform","translateY("+r+"px)"),a.find(".text-wrap").css("-webkit-transform","translateY("+r+"px)"),a.find(".text-wrap").css("-moz-transform","translateY("+r+"px)"),a.appendTo(".browse-tote-wrap")}),resizeHandler(),checkFavorites(),animateIn()})}function animateIn(){$.each(toteBags,function(t,e){setTimeout(function(){$(".tote-grid-element").eq(t).removeClass("start")},50*t)})}function animateInHelper(t){t>toteBags.length||setTimeout(function(){$(".tote-grid-element").eq(t).removeClass("start"),animateInHelper(next)},20*t)}function resizeHandler(){var t=$(window).width(),e=4;if(e=oneColumnMax>=t?1:t>oneColumnMax&&twoColumnMax>=t?2:t>twoColumnMax&&threeColumnMax>=t?3:4,currColumns!==e){var a=e/maxColumns;$.each(toteBags,function(t,r){var s=Number(r.yAxis)*a*multiplier/e,n=$("#tote-"+t);n.find(".text-wrap").css("transform","translateY("+s+"px)"),n.find(".text-wrap").css("-webkit-transform","translateY("+s+"px)"),n.find(".text-wrap").css("-moz-transform","translateY("+s+"px)")}),currColumns=e}}function checkFavorites(){$.each(toteBags,function(t,e){hasLike(e._id)&&$("#tote-"+t+" .heart-wrap").addClass("favorited")})}var multiplier=1.1,maxColumns=4,currColumns=4,oneColumnMax=800,twoColumnMax=1150,threeColumnMax=1500,toteBags=[];$(document).ready(function(){loadBags(),$(window).resize(function(){resizeHandler()}),$(document).hammer().on("tap",".heart-wrap",function(t){var e=Number($(this).parents(".tote-grid-element").attr("id").substr(5)),a=toteBags[e],r=a._id,s=$(this).hasClass("favorited");a.likes=s?Number(a.likes)-1:Number(a.likes)+1;var n=jQuery.extend(!0,{},a);delete n._id,$.ajax({type:"PUT",data:n,url:"/totes/updatetote/"+r}).done(function(t){""===t.msg?s?(removeLike(r),$("#tote-"+e+" .heart-wrap").removeClass("favorited")):(addLike(r),$("#tote-"+e+" .heart-wrap").addClass("favorited")):console.log("Error: "+t.msg)})})});