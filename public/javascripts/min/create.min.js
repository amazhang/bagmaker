function toggleBagSizeUI(e){var t=$(".bag-size-wrap").outerWidth()-$(".bag-size-wrap .selector").outerWidth(),a=$(".bag-size-wrap");"undefined"==typeof e&&a.hasClass("small")||"big"===e?(a.removeClass("small"),a.addClass("big"),TweenLite.to(".bag-size-wrap .selector",.3,{x:t,ease:cssBezier}),newBag.toggleSize("big")):("undefined"==typeof e&&a.hasClass("big")||"small"===e)&&(a.removeClass("big"),a.addClass("small"),TweenLite.to(".bag-size-wrap .selector",.3,{x:0,ease:cssBezier}),newBag.toggleSize("small"))}var newBag;$(document).ready(function(){function e(e){var t=e.parents(".editable-field"),a=_.findWhere(newBag.data.textfields,{domid:t.attr("id")});if(e.parent().hasClass("size")){var i=e.val();t.css("font-size",i+"em"),a.fontSize=Number(i)}else if(e.parent().hasClass("kerning")){var n=e.val();t.css("letter-spacing",n+"em"),a.kerning=Number(n)}else if(e.parent().hasClass("leading")){var s=e.val();t.css("line-height",s+"em"),a.leading=Number(s)}newBag.updateTextAreaSize(t.find("textarea"))}newBag=_.extend({},bagObject),newBag.data.editMode=!0,newBag.newTextField(),newBag.draw($(".content.create-page .bag-wrap"),function(){$(".editable-field").eq(0).addClass("selected"),$(".editable-field").eq(0).find("textarea").focus(),setTimeout(function(){var e=$(document).height()-$(window).height();$("body").animate({scrollTop:e},"slow")},100)}),$(document).hammer().on("tap",".bag-size-wrap > *",function(e){e.preventDefault(),e.stopPropagation(),toggleBagSizeUI()}),$(document).hammer().on("drag",".bag-size-wrap .selector",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).parents(".bag-size-wrap").hasClass("big");if("left"===e.gesture.direction&&t){var a=e.gesture.deltaX,i=$(".bag-size-wrap").outerWidth()-$(".bag-size-wrap .selector").outerWidth(),n=i+a;0>n&&(n=0),TweenLite.to($(this),0,{x:n+"px"})}else if("right"===e.gesture.direction&&!t){var a=e.gesture.deltaX,i=$(this).parents(".bag-size-wrap").outerWidth()-$(this).outerWidth();a>i&&(a=i),TweenLite.to($(this),0,{x:a+"px"})}}),$(document).hammer().on("dragend",".bag-size-wrap .selector",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).parents(".bag-size-wrap").hasClass("big");"left"===e.gesture.direction&&t?toggleBagSizeUI("small"):"right"!==e.gesture.direction||t||toggleBagSizeUI("big")}),$(document).hammer().on("tap",".color-control-wrap .color-control",function(e){e.preventDefault(),e.stopPropagation(),$(this).parents(".color-control-wrap").toggleClass("expand")}),$(document).hammer().on("tap",".color-control-wrap .colors .color-wrap",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).parents(".color").attr("rel");newBag.changeColor(t),$(this).parents(".color-control-wrap").removeClass("expand")}),$(document).hammer().on("tap",".addTextfield:not(.disabled)",function(e){e.preventDefault(),e.stopPropagation(),$(".editable-field.new").length>0?($(".editable-field").removeClass("selected"),setTimeout(function(){$(".editable-field.new").eq(0).addClass("selected")},100)):(newBag.newTextField(),newBag.draw())}),$(document).hammer().on("tap",".editable-field .corner.tr",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).parents(".editable-field").attr("id");newBag.deleteTextField(t)}),$(document).on("keyup",".editable-field textarea",function(){newBag.updateTextAreaSize($(this))}),$(document).hammer().on("tap",".editable-field",function(e){e.preventDefault(),e.stopPropagation(),$(".editable-field").removeClass("selected"),$(this).addClass("selected")}),$(document).hammer().on("tap",":not(.editable-field, .editable-field *)",function(e){e.preventDefault(),e.stopPropagation(),$(".editable-field.selected").removeClass("selected")}),$(document).hammer().on("tap",".text-controls .justification > *",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).parents(".editable-field"),a=_.findWhere(newBag.data.textfields,{domid:t.attr("id")});$(this).siblings(".sel").removeClass("sel");var i=$(this).attr("class").split("-")[1];a.justify=i,$(this).parents(".editable-field").css("text-align",i),$(this).addClass("sel")}),$(document).on("input",".type-control input",function(t){t.preventDefault(),t.stopPropagation(),e($(this))}),$(document).hammer().on("drag",".editable-field, editable-field .corner",function(e){if(1!==$(e.target).parents(".text-controls").length){var t=$(this);if($(this).hasClass("corner")&&(t=$(this).parents(".editable-field")),"up"===e.gesture.direction||"down"===e.gesture.direction){var a=e.gesture.deltaY,i=t.attr("id"),n=parseInt(t.parents(".bag-body").css("font-size")),s=_.findWhere(newBag.data.textfields,{domid:i}),r=s.y*n,o=a+r;0>o?o=0:o+t.height()>t.parents(".textfields-wrap").height()&&(o=t.parents(".textfields-wrap").height()-t.height()),TweenLite.to(t,0,{y:o+"px"})}}}),$(document).hammer().on("dragend",".editable-field, editable-field .corner",function(e){if(1!==$(e.target).parents(".text-controls").length){var t=$(this);if(0!==$(this).parents(".editable-field").length&&(t=$(this).parents(".editable-field")),"up"===e.gesture.direction||"down"===e.gesture.direction){var a=e.gesture.deltaY,i=t.attr("id"),n=parseInt(t.parents(".bag-body").css("font-size")),s=_.findWhere(newBag.data.textfields,{domid:i}),r=s.y*n,o=a+r;0>o?o=0:o+t.height()>t.parents(".textfields-wrap").height()&&(o=t.parents(".textfields-wrap").height()-t.height()),s.y=o/n}}}),$(document).hammer().on("tap","button.save",function(){newBag.saveAs()})});