function userLikesToArray(){var e=$.cookie("likes");return e.split(",")}function addLike(e){var t=userLikesToArray();return hasLike(e)?!1:(t.push(e),void $.cookie("likes",t))}function removeLike(e){var t=userLikesToArray(),n=t.indexOf(e);return hasLike(e)?(t.splice(n,1),void $.cookie("likes",t)):!1}function hasLike(e){var t=userLikesToArray(),n=t.indexOf(e);return-1!==n}!function(e,t,n,i,a,r,s){e.GoogleAnalyticsObject=a,e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].l=1*new Date,r=t.createElement(n),s=t.getElementsByTagName(n)[0],r.async=1,r.src=i,s.parentNode.insertBefore(r,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-58975311-1","auto");var site={colors:["black","white","orange","yellow","cyan","red","green"],chars:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split(""),randomString:function(e){for(var t="",n=0;e>n;n++)t+=site.chars[Math.floor(Math.random()*site.chars.length)];return t},breakpts:{sml:650,med:960,lrg:1440},transistionEnd:"webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",breakpt:function(){var e=window.innerWidth,t="lrg";for(var n in site.breakpts)if(site.breakpts[n]>=e){t=n;break}return t},refreshTypeOnTotes:function(){_.each($(".actual-tote"),function(e){var t=$(e).find(".bag-body").width(),n=t/2;$(e).find(".bag-body").css("font-size",n+"px");for(var i=$(e).find(".textfields-wrap .editable-field"),a=0;a<i.length;a++)bagObject.updateTextAreaSize($(i[a]).find("textarea"))})},getTransformValue:function(e,t){var n=e.css("transform").replace(/[^0-9\-.,]/g,"").split(","),i=n[12]||n[4],a=n[13]||n[5];return void 0===i&&(i=0),void 0===a&&(a=0),"x"===t?i:"y"===t?a:void 0},render:function(e,t,n,i){$.get("/templates/_"+t+".html",function(t){var a=Handlebars.compile(t),r=a(e);$(n).html(r),"undefined"!=typeof i&&i()})}},bagObject={data:{textfields:[],size:"small",color:"black",likes:0,editMode:!1},htmlElement:null,parent:null,refreshType:function(){var e=this.htmlElement,t=e.find(".bag-body").width(),n=t/2;e.find(".bag-body").css("font-size",n+"px")},toggleSize:function(e){var t=this;"big"===e||"small"===t.data.size&&"undefined"==typeof e?(t.data.size="big",t.htmlElement.removeClass("small").addClass("big")):("small"===e||"big"===t.data.size&&"undefined"==typeof e)&&(t.data.size="small",t.htmlElement.removeClass("big").addClass("small")),setTimeout(function(){t.refreshType()},300)},changeColor:function(e){var t=this;_.contains(site.colors,e)&&$(t.htmlElement).attr("class","tote-wrap "+e+" "+t.data.size)},updateTextAreaSize:function(e){var t=this,n=e.parents(".editable-field"),i=n.attr("data-id"),a=e.siblings(".clone-text"),r=e.val();if(""===r&&(r="Type Something."),a.html(r.replace(/\n/g,"<br />")),t.data&&t.data.textfields){var s=_.findWhere(t.data.textfields,{_id:i});s.text=r,""===e.val()?n.addClass("new"):n.removeClass("new");var o=parseInt(n.parents(".bag-body").css("font-size")),d=s.x*o,l=s.y*o;TweenLite.to(n,0,{x:d,y:l})}TweenLite.to(n,.1,{height:a.height()})},draw:function(e,t){var n=this;if("undefined"==typeof e&&null!==n.parent)e=$(n.parent);else{if(null===n.parent&&"undefined"==typeof e)return void console.log("you done fucked up");null===n.parent&&"undefined"!=typeof e&&(n.parent=e)}var i={bags:[n.data]};site.render(i,"bag",n.parent,function(){n.htmlElement=n.parent.find(".tote-wrap"),site.refreshTypeOnTotes(),"undefined"!=typeof t&&t()})},newTextField:function(){for(var e={y:0,x:0,width:"100%",justify:"left",fontSize:.28,kerning:-.03,leading:1},t=site.randomString(16);"undefined"!=typeof _.findWhere(this.data.textfields,{_id:t});)t=site.randomString(16);e._id=t,this.data.textfields.push(e),this.data.textfields.length>=4&&$(".addTextfield").addClass("disabled")},deleteTextField:function(e,t){var n=this,i=$(this.htmlElement).find(".editable-field[data-id="+e+"]");TweenLite.to(i,.3,{scale:1.15,alpha:0,onComplete:function(){i.remove(),n.data.textfields=_.reject(n.data.textfields,function(t){return t._id===e}),n.data.textfields.length<4&&$(".addTextfield").removeClass("disabled"),"undefined"!=typeof t&&t()}})},saveAs:function(){var e=_.extend({},this.data);e.textfields=JSON.stringify(e.textfields,null,"	"),e.editMode=null,e.timestamp=Math.round((new Date).getTime()/1e3),$.ajax({type:"POST",data:e,url:"/totes/createtote",dataType:"JSON"}).done(function(e){""===e.msg?window.location.href="/":alert("Error: "+e.msg)})}};$(document).ready(function(){void 0===$.cookie("likes")&&$.cookie("likes",""),$(document).hammer().on("tap",".logo",function(){window.location.href="/"}),site.refreshTypeOnTotes(),$(window).resize(function(){site.refreshTypeOnTotes()}),ga("send","pageview")});